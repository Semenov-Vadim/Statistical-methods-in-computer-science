
if __name__ == "__main__":
	a = [
			[[0.6799, 1.633, 0.8227, -0.3971, -0.7884, -0.3994, 0.6813, 0.8728, 0.5036, 1.067, -0.1591, 0.3424, 0.7422,
		  -0.7272, 0.3692, 0.7994, 1.223, -0.2048, -0.7787, -0.5993, 0.6351, 0.3673, 1.424, -0.0627, -0.2483, -0.5872,
		  -0.8961],
		 [0.4764, 1.164, -0.2085, -1.536, -0.8166, -0.8204, 0.4529, 0.0034, 1.31, -0.2465, -0.9506, -0.9863, -1.578,
		  0.5254, -1.06, -0.9883, -1.083, -0.5537, 0.6576, 0.6038, -1.395, -0.7834, -0.9982, -0.0053, 0.9993, 0.8102,
		  0.202],
		 [0.6961, 0.8602, 0.6586, 0.0221, -0.9032, -1.614, -1.448, -0.883, -0.1226, -0.1834, 0.2399, 0.593, 0.9544,
		  0.5099, -0.4635, -1.394, -1.822, -0.9184, 0.5307, 0.3004, 0.7369, 1.284, 1.019, 0.6098, -0.9375, -1.28,
		  -0.7583]],
		[[0.87, 1.184, 0.7592, -0.1255, -0.5077, -0.5436, 0.1322, 0.556, 0.2757, 0.3766, 0.3672, 0.2366, 0.1436, -1.114,
		  0.839, 0.941, 0.5601, -0.02633, -0.5775, -0.6124, 0.6851, 1.404, 1.308, 0.4237, 0.3474, -0.9183, -0.8691],
		 [0.9882, 0.9357, 0.6578, -0.8345, -1.038, -0.3984, 1.729, 0.9607, 0.798, -0.4459, -0.8634, -1.329, -1.356,
		  0.6167, -1.106, -0.8802, -1.638, -0.0478, 0.8674, 1.127, -0.9448, -1.335, -0.4458, 0.0243, 0.634, 0.9821,
		  1.484],
		 [1.29, 1.061, 0.9428, -0.5982, -1.112, -0.7411, -0.7765, -1.082, -0.5615, -0.2555, 0.7838, 0.0452, 1.228,
		  0.0409, -1.031, -0.8135, -0.924, -0.5639, -0.1313, 0.4117, 0.4113, 0.4744, 0.5663, 0.5698, -0.6647, -0.5926,
		  -0.4156]],
		[[1.345, 1.205, 0.4678, -0.7966, -1.526, -1.629, 0.2969, 0.2569, 0.8038, 1.177, 0.5013, 0.3049, -0.0861,
		  -0.5333, 0.3588, 0.896, 0.9482, 0.2619, -1.763, -0.4201, 0.7582, 1.021, 1.003, 0.9356, -0.0189, -0.7506,
		  -0.1975],
		 [0.2514, 0.6214, 0.6053, -1.222, -0.3644, -0.4545, 0.9248, 0.8464, 0.501, -0.215, -1.294, -0.5713, -1.066,
		  0.8439, -0.1612, -1.07, -0.7607, -0.5832, 0.75, 0.7096, -1.041, -0.9542, -1.392, -0.08585, 1.185, 0.8767,
		  0.8265],
		 [1.199, 0.7689, -0.1525, -0.1482, -1.289, -0.716, -0.6235, -1.212, -0.7975, -0.4337, -0.0115, 1.172, 0.2479,
		  0.5138, -1.006, -1.063, -1.606, -1.186, 0.3166, 0.1799, 1.134, 1.474, 0.4272, 0.5471, -0.7129, -0.7118,
		  -0.6956]],
		[[0.7872, 1.118, 0.8967, 0.0955, -0.8006, -2.015, 0.1036, 0.2576, 1.481, 1.172, 0.6315, -0.1266, 0.4455, 0.0463,
		  1.16, 1.397, 1.108, -0.08281, -1.69, -1.584, -0.0719, 1.209, 0.9464, 0.241, -0.6121, -0.4726, -0.1211],
		 [0.4928, 1.237, -0.4449, -1.593, -0.6958, -0.2514, 1.54, 0.9304, 0.8561, -0.1316, -1.227, -1.143, -0.6582,
		  0.1923, -0.6268, -1.743, -0.8886, -0.1832, 1.008, 0.6547, -0.8294, -1.43, -0.6854, -0.8402, 1.202, 0.5935,
		  0.2688],
		 [0.4435, 1.212, 1.418, -0.1796, -1.222, -0.88, -0.8724, -0.8708, -0.5534, -0.2238, 1.116, 1.005, 1.494,
		  -0.2314, -0.3929, -0.9517, -0.8653, -0.9792, 0.8105, 0.4993, 0.7631, 1.272, 0.7345, 0.3073, -0.4639, -0.293,
		  -0.8541]],
		[[1.827, 1.279, 1.093, -0.8458, -0.9136, -0.9921, 0.1336, 0.8826, 0.9161, 1.31, 0.6651, 0.2833, 0.2593, -0.5982,
		  0.8663, 0.766, 0.8412, -0.2185, -1.37, -1.469, 0.4309, 0.4967, 0.6659, 0.7717, -0.2936, -1.228, -0.0793],
		 [0.1429, 0.8795, 0.5823, -1.341, -1.285, -1.043, 0.7352, 0.5126, 0.403, 0.2396, -0.8448, -0.8677, -1.635,
		  0.1458, -0.609, -1.699, -1.427, -0.3606, 1.508, 0.2663, -1.006, -1.383, -1.039, -0.4225, 1.14, 0.6526,
		  0.8891],
		 [0.9048, 1.276, 0.9346, -0.1605, -0.8241, -0.513, -0.4773, -0.3676, -0.0942, 0.1734, 0.1265, 0.2325, 0.8594,
		  1.099, -0.9801, -0.9938, -0.7817, -0.9671, -0.1512, 0.8973, 0.9601, -0.145, 0.7343, 0.2805, -0.5342, -0.4153,
		  -0.7134]],
		[[0.6791, 0.8947, 0.9233, -0.5432, -0.4278, -1.133, 0.0561, 0.6335, 0.9708, 1.002, 0.5961, 0.1334, 0.2833,
		  -0.4909, 0.748, 0.2876, 0.3237, 0.2618, -0.7587, -1.406, 0.8146, 0.838, 1.098, 0.9993, 0.0319, -0.7311,
		  -0.7712],
		 [0.1792, 0.5268, 0.6216, -1.093, -1.522, -0.4914, 0.8478, 0.9099, 0.364, 0.1104, -0.9279, -1.506, -1.704,
		  0.9144, -0.9545, -1.363, -0.5608, 0.1836, 0.6299, 0.1409, -0.2301, -1.026, -1.649, 0.3909, 1.57, 0.5523,
		  0.8087],
		 [0.4281, 0.8917, 0.4418, -0.1098, -0.9361, -1.063, -1.105, -0.2571, -0.3332, -0.1743, 0.1355, 0.112, 0.8651,
		  -0.0087, -1.28, -1.478, -1.14, -0.7446, 0.3011, 0.5614, 0.9801, 0.8189, 0.8291, -0.1244, -0.9907, -0.7027,
		  -1.234]],
		[[1.455, 0.896, 0.9421, -0.8336, -0.376, -1.099, 0.4924, 0.5341, 0.5521, 0.2644, 0.7708, 0.5082, 0.4087, -0.469,
		  1.132, 0.9723, 1.164, 0.5432, -0.7491, -1.054, 0.7844, 0.2731, 0.7639, 1.222, -0.1614, -0.2228, -0.8282],
		 [0.5883, 0.655, 0.8339, -1.356, -0.9035, -0.7699, 0.9635, 0.4256, 0.6809, 0.3863, -0.7528, -1.169, -0.9974,
		  1.01, 0.0337, -1.184, -0.7274, -0.3832, 1.566, 0.9707, -0.7645, -1.149, -1.368, 0.1536, 0.6727, 0.6717,
		  0.9939],
		 [0.6562, -0.0069, 0.0879, -0.2649, -0.7834, -0.7018, -0.6242, -0.1942, -0.6143, 0.0695, 0.2604, 1.058, 0.8763,
		  0.6272, -0.491, -1.265, -0.4664, -1.282, 0.4462, 0.5609, 0.8826, 1.069, 0.2682, 0.4098, -0.6632, -0.062,
		  -0.4782]],
		[[0.9541, 1.066, 0.2136, -0.9846, -0.5432, -0.9975, 0.3534, 1.448, 0.5902, 1.302, 1.269, 0.0803, 0.1676,
		  -0.4711, 0.7336, 0.2905, 1.128, -0.3673, -1.095, -0.7657, 0.4628, 0.9717, 0.7585, 0.4397, -0.091, -0.4339,
		  -0.8053],
		 [0.1853, 0.879, -0.2054, -1.265, -1.31, -1.837, 0.447, 0.7183, 0.3291, 0.8406, -0.7976, -1.446, -0.5866,
		  0.6171, -0.8518, -1.245, -0.9231, -0.0555, 1.011, 0.4858, -0.9055, -0.6872, -0.8067, 0.468, 0.9954, 0.4803,
		  1.191],
		 [0.7974, 1.694, 0.0603, -0.1894, -0.8742, -0.4359, -0.8025, -0.9122, -0.6347, -0.5824, 0.4061, 0.5487, 0.6971,
		  0.4046, -0.5224, -1.172, -1.063, -0.6369, 0.1513, 0.9478, 1.644, 1.283, 1.15, 0.571, -0.607, -1.5, -1.52]],
		[[0.5106, 1.4, 0.8621, -0.0488, -0.9293, -0.481, 0.0198, 0.2749, 0.8617, 1.803, 0.4951, 0.0347, 0.6658, 0.0065,
		  1.368, 0.791, 0.9765, 0.1246, -1.332, -0.698, 0.7244, 0.4948, 1.14, 1.1, -0.2178, -0.7633, -0.0647],
		 [0.9214, 0.8424, -0.3843, -1.53, -0.916, -0.7264, 0.6705, 0.8749, 0.6681, 0.4129, -0.2669, -0.5138, -1.093,
		  0.7312, -0.866, -1.543, -1.709, -0.0541, 0.5383, 0.4581, -0.8844, -0.8255, -1.01, -0.4694, 0.482, 0.765,
		  0.9053],
		 [0.7414, 0.4589, 0.4494, -0.74, -0.8054, -0.3379, -1.24, -1.396, -0.9256, -0.5463, 0.9153, 0.8802, 0.8447,
		  0.0426, -0.497, -0.6539, -0.723, -0.7421, -0.0159, 0.0651, 0.3467, 0.8154, 0.6507, 0.5291, -0.7837, -0.2297,
		  -0.1748]],
		[[0.389, 1.18, 1.065, -0.6671, -0.2048, -0.278, -0.0332, 1.077, 0.9522, 0.8786, 0.4342, 0.2813, 0.06823,
		  -0.6852, 0.5053, 0.1304, 0.5085, -0.00162, -1.472, -0.7842, 1.022, 1.153, 1.445, 0.9636, -0.8313, -0.2863,
		  -0.3297],
		 [0.1286, 1.357, -0.3827, -1.766, -1.274, -0.892, 0.5261, 0.4194, 0.561, 0.9237, -0.6121, -0.753, -0.7196,
		  0.7487, 0.1825, -1.325, -1.452, -0.5517, 0.6624, -0.1153, -1.472, -0.5043, -1.95, -0.2142, 0.7029, 0.2805,
		  1.128],
		 [0.9963, 0.5217, 0.4102, 0.0004, -0.6622, -1.229, -0.1503, -0.3859, -0.4502, -1.016, 0.4598, 0.2187, 0.7926,
		  0.0389, -0.8067, -0.6256, -1.171, -0.2766, 0.11, 0.8353, 1.229, 0.7918, 0.9102, 0.3706, -0.3801, -0.5672,
		  -0.2852]],
		[[0.5758, 1.495, 0.7338, -0.6614, -0.7299, -1.436, 0.3006, 1.544, 1.158, 0.7442, 0.5831, 0.6916, -0.3328,
		  -0.4512, 0.3802, 0.8313, 1.211, -0.4679, -0.7434, -1.219, 0.569, 1.288, 1.132, 0.6551, -0.2813, -0.594,
		  -0.7264],
		 [1.846, 0.1488, 0.2178, -1.459, -1.212, -0.5136, 1.31, 0.2543, 0.1861, -0.2339, -0.6318, -0.5019, -1.352,
		  0.6419, -0.381, -1.236, -0.6803, -0.1577, 0.4071, 0.829, -0.8706, -1.352, -1.288, 0.1181, 0.6386, 0.3503,
		  1.084],
		 [1.137, 1.107, 1.523, -0.7986, -0.8635, -0.1911, -0.9601, -0.3445, -0.7447, 0.257, 0.2286, 0.0447, 1.03,
		  0.4837, -1.462, -1.206, -0.6348, -0.39, 0.1546, 0.1192, 1.422, 0.9222, 0.4171, -0.4422, -0.894, -0.9802,
		  -0.2945]],
		[[0.6042, 1.221, 0.0886, -0.7956, -0.7834, -0.928, 0.8107, 0.6779, 1.344, 1.062, 0.9096, 0.0926, -0.5371,
		  -0.4696, 0.3686, 0.9308, 0.5445, 0.02473, -0.8324, -0.8628, 1.364, 0.6541, 0.1528, 1.274, -0.9011, -0.1262,
		  -0.4098],
		 [0.7098, 1.15, 0.71, -0.2309, -1.156, -0.5282, 1.037, 0.8275, 0.5041, 0.05732, -0.6122, -0.8532, -1.335,
		  0.9149, -0.087, -1.312, -0.5581, 0.6314, 1.11, -0.3593, -1.034, -0.7249, -1.027, -0.1365, 0.8558, 0.9136,
		  1.021],
		 [0.6853, 0.8244, 0.2554, -0.1506, -0.0092, -0.4024, -0.9078, -0.6722, -0.6135, -0.0195, 0.2392, 0.7781, 0.9652,
		  -0.2994, -0.8264, -1.277, -0.997, -0.8424, 0.7082, 0.5454, 1.355, 0.7182, 1.002, 0.0871, -0.4224, -1.058,
		  -1.383]]

	]

	# оценка мат ожидания
	ksi = [[], [], []]
	for i in range(len(a[0][0])):
		sum_0 = 0
		sum_1 = 0
		sum_2 = 0
		for j in range(len(a)):
			sum_0 += a[j][0][i]
			sum_1 += a[j][1][i]
			sum_2 += a[j][2][i]
		ksi[0].append((1/len(a)) * sum_0)
		ksi[1].append((1/len(a)) * sum_1)
		ksi[2].append((1/len(a)) * sum_2)

	print("оценка математического ожидания:")
	print(ksi[0])
	print(ksi[1])
	print(ksi[2])

	# вычисление ковариационной функции случайного процесса для моментов времени t1, t2
	# при t1= 3, t2 = 8

	t1 = 3
	t2 = 8
	temp1 = [0, 0, 0]
	temp2 = [0, 0, 0]
	K = [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]

	for i in range(len(a)):
		for j in range(len(a[0])):
			temp1[j] = a[i][j][t1 - 1] - ksi[j][t1 - 1]
			temp2[j] = a[i][j][t2 - 1] - ksi[j][t2 - 1]

	for k in range(3):
		for m in range(3):
			K[k][m] = (1/(len(a)-1))*(temp1[k] * temp2[m])

	print("\nКовариационная функция в точках t3, t8:")
	for i in range(3):
		print(K[i])

	t1 = 8
	t2 = 3
	temp1 = [0, 0, 0]
	temp2 = [0, 0, 0]
	K = [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]

	for i in range(len(a)):
		for j in range(len(a[0])):
			temp1[j] = a[i][j][t1 - 1] - ksi[j][t1 - 1]
			temp2[j] = a[i][j][t2 - 1] - ksi[j][t2 - 1]

	for k in range(3):
		for m in range(3):
			K[k][m] = (1 / (len(a) - 1)) * (temp1[k] * temp2[m])

	print("\nКовариационная функция в точках t8, t3:")
	for i in range(3):
		print(K[i])
