
if __name__ == "__main__":
	list_o = [4,	3,	3,	4,	1,	8,	5,	8,	3,	7,	8,	7,	5,	7,	1,	4,	6,	5,	6,	8,	4,	6,	5,	7,	4,	7,	7,	8,	3]

	list_a = [[0.049551920524198,	0.0588691914647662,	0.164277999824098,	0.123655555963958,	0.169300644493642,	0.153767735585808,	0.106465132113329,	0.174111819963003],
			[0.153206966957872,	0.127379022809256,	0.0487195908519435,	0.274040820754842,	0.136932083308441,	0.0516891455766161,	0.145982767776586,	0.0620496020605466],
			[0.145805219068842,	0.220294267293589,	0.118857420086213,	0.00025990716552454,	0.12027271884383,	0.212927454189051,	0.136887695784638,	0.0446953179908964],
			[0.0876530191314437,	0.0193694291262452,	0.0303522616559273,	0.178267744672284,	0.170904030381446,	0.285369904861984,	0.0388750623790293,	0.189208547486873],
			[0.132006720459071,	0.166591928374668,	0.0931611522214446,	0.168285468187167,	0.101070898470196,	0.140061587921107,	0.162857040872263,	0.0359652036808325],
			[0.0872195503109798,	0.170475543410637,	0.226573367594085,	0.147800300102303,	0.0265108604887995,	0.0383081088800931,	0.0537507998791352,	0.249361469375884],
			[0.12484951182629,	0.0493438484661252,	0.147206208244565,	0.260047810860309,	0.000889272550627883,	0.131244708307011,	0.150016716058443,	0.1364019234657],
			[0.142937711216951,	0.0816128560074698,	0.0477210123799724,	0.0852868401683162,	0.0605851759683887,	0.0655626220825681,	0.262565923085199,	0.253727859029084]
	]
	list_b = [[0.0530125534540157,	0.178060354431982,	0.272538872877342,	0.0173623406550448,	0.0363547719558354,	0.290680708937348,	0.0604641683300201,	0.0915262292421738],
			[0.15930009064216,	0.176130465396494,	0.00745715870834171,	0.168623750778155,	0.120563990978851,	0.136443243872697,	0.190471163916104,	0.0410101354062072],
			[0.130543432450356,	0.137117042134239,	0.22459005318225,	0.174767521959042,	0.19665116464683,	0.0313642187408032,	0.00829909950737151,	0.0966674676767071],
			[0.26384413079082,	0.079755001563033,	0.243470550087961,	0.124138678654173,	0.0313882607244107,	0.0302599586981758,	0.090107214070684,	0.137036205425047],
			[0.168331466480691,	0.00936784118432152,	0.0852539397038984,	0.202977373089693,	0.178403772063524,	0.139184930251195,	0.0193949480280188,	0.197085729371075],
			[0.130495456365335,	0.113886278951358,	0.168882101841388,	0.0325676754994012,	0.180081595508258,	0.0486969716076275,	0.205946437269481,	0.119443483045024],
			[0.201457888779888,	0.152547331191074,	0.17375258449417,	0.0559322368297457,	0.0292572392138431,	0.1768713314569,	0.191953395599521,	0.0182279927534134],
			[0.108852521477181,	0.174019527054561,	0.154451314624106,	0.106001715776047,	0.0641681695394322,	0.152264583365241,	0.224789025835852,	0.0154531425393655],
	]
	list_pi = [0.049551920524198,	0.0588691914647662,	0.164277999824098,	0.123655555963958,	0.169300644493642,	0.153767735585808,	0.106465132113329,	0.174111819963003]

	sigma = []
	psi = []

	for i in range(len(list_o)):
		if i == 0:
			# 1. Initialization
			for i in range(len(list_o)):
				sigma.append([])
			for i in range(len(list_pi)):
				s = list_pi[i] * list_b[i][list_o[0] - 1]
				sigma[0].append(s)

			for i in range(len(list_o)):
				psi.append([])
			for i in range(len(list_pi)):
				psi[0].append(0)
		else:
			# 2. Recursion
			for j in range(len(list_pi)):
				max = 0
				value = 0
				argmax = 0
				for j_2 in range(len(list_pi)):
					value = sigma[i - 1][j_2] * list_a[j_2][j]
					if value > max:
						max = value
						argmax = j_2
				sigma[i].append(max * list_b[j][list_o[i] - 1])
				psi[i].append(argmax)

	print('sigma:')
	for i in range(len(sigma)):
		print(sigma[i])

	print('\npsi:')
	for i in range(len(sigma)):
		print(psi[i])

	# 3. Completion
	max = 0
	argmax = 0
	for i in range(len(list_a)):
		s = sigma[len(list_o) - 1][i]
		if s > max:
			max = s
			argmax = i
	print('\nИскомая вероятность: ', max)


	q = []
	for i in range(len(list_o)):
		q.append(0)

	for i in range(len(list_o)):
		if i == 0:
			q[len(list_o) - 1] = argmax
		else:
			q[len(list_o) - i - 1] = psi[len(list_o) - i][q[len(list_o) - i]]

	print('последовательность скрытых состояний Q:', q)

